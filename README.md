# CV Filtering System

An automated CV filtering system that extracts information from resumes and matches them with job offers using OpenAI.

## Features

- Extract key information from CVs using LLM prompts
- Match candidates with job positions using LLM evaluation
- Provide scoring and explanations generated by LLM
- Docker-based deployment with OpenAI API
- SQLite-based caching for performance

## Quick Start

### Prerequisites

- Docker and Docker Compose installed

### Running the Application

1. Set your OpenAI API key:
```bash
export OPENAI_API_KEY=your_key_here
```

2. Start the services:
```bash
docker compose up
```

3. Access the API documentation:
```
http://localhost:8000/docs
```

## API Usage

### POST /match

Match a CV against a job description.

**Request**: Multipart form data
- `cv`: File (PDF, DOCX, TXT, MD)
- `job_description`: File (MD, TXT)

**Response**:
```json
{
  "match": true,
  "overall_score": 85,
  "criteria_scores": {
    "skills": 90,
    "experience": 80,
    "location": 95,
    "education": 75,
    "certifications": 70
  },
  "explanation": "Candidate shows strong alignment...",
  "cached": false,
  "processing_time_ms": 1250
}
```

## Architecture

- **API Layer**: FastAPI with async support
- **LLM**: OpenAI GPT-3.5-turbo for all processing
- **Matching**: LLM-based scoring via prompts
- **Database**: SQLite for caching
- **Scoring**: Generated entirely by LLM using structured prompts
- **Prompts**: Stored in `app/prompts/` for easy customization

## Development

Run tests:
```bash
docker compose exec app pytest
```

View logs:
```bash
docker compose logs -f app
```

## Configuration

Environment variables can be modified in `docker-compose.yml`:
- `OPENAI_MODEL`: Model to use (default: gpt-3.5-turbo)
- `MATCH_THRESHOLD`: Minimum score for a match (default: 70)
- `CACHE_TTL_HOURS`: Cache retention period (default: 168)

## Troubleshooting

### OpenAI API Error

If you get an API error:

1. **Check API key is set:**
   ```bash
   echo $OPENAI_API_KEY
   ```

2. **Set API key:**
   ```bash
   export OPENAI_API_KEY=your_key_here
   docker compose up
   ```

3. **Check API key validity:** Visit https://platform.openai.com/api-keys

4. **Check billing:** Ensure your OpenAI account has credits

5. **Check logs:**
   ```bash
   docker compose logs app
   ```